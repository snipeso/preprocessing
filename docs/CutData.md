# Suggestions on what data to cut
This is a compilation of what to remove in step 2 of visual inspection.
There are 3 ways to remove data at this stage:
- Cut out a segment in time across all channels
- Remove a whole channel
- Remove a segment in one or few channels for a few seconds

Since this is an "arbitrary" process, it is important that you don't introduce systematic bias, for example cleaning seperately conditions you later compare, especially if you have reason to believe they might have different levels of noise.
It's also best if you don't know what file you're cleaning each time.

> The goals to keep in mind are, in order:
> 1. Remove anything that would mask data
> 2. Preserve as much data as possible
> 3. Have the data as clean as possible

The most important thing is that nothing is left in the recording that directly affects your outcome measures of real brain signal. This is very much a "you know it when you see it" type of artifact. Point 2 is about going to the effort of salvaging data in the middle of noise. An ojection to doing this manually, without clear thresholds or fixed criteria, is that you can introduce bias by removing noise in one condition, but not another. This is true, but the alternative is having no data at all, which isn't any better. If the idea is to clean heavily noisy data, why not just leave more noise in the cleaner sets so that it's more even? Becuase it gets a lot harder to say if something could be noise or signal if you never have any completely clean data. 

The criteria in order of importance when deciding what to remove or not:
1. **How big is it?** If the occurance involves crazy high amplitudes relative to the rest of the signal, it needs removing.
2. **Does it have any signal left in it?** If the noise is such that you can't see any underlying EEG, then it should be removed, no doubt.
3. **Could it mask important EEG effects?** If the noise has similar properties to the type of analysis you'll be doing, such as a certain spectrum (1-40Hz), you'll want to get rid of it if you're sure that it's not infact generated by the brain.
4. **Does it clearly look un-physiological?** If the noise is clearly not data, like periodic spikes, it makes sense to remove them.
5. **Does it clearly not come from the brain?** This especially applies to muscle artefacts; if you're confident it's not some high-frequency beta burst, but rather muscle activity, I would remove it. 


When NOT to remove some data:
1. **It's possibly brain data**: don't remove anything that is plausably generated by the brain, and only by the brain. Err on the side of caution if you're uncertain, and leave it in.
2. **It can be removed with ICA**: don't remove anything that you know will go away with ICA, namely eye movements (blinks, saccades, rolling eye movements) and heartbeat. Vice versa, if you know something can't be properly removed with ICA (like single-occurance events, or high-frequency bursts), it's a good reason to cut it out. 
3. **The discontinuity is more detrimental than the noise**: if an artefact is small, selecting it as a segment to be removed can create more of an artefact from "edge artifacts", for example in power calculations or ERPs.
4. **Too much data has been removed, and it's not too bad**. This applies when you have a lot of worse noise in the file, and this timepoint/channel still preserves a reasonable amount of signal. It's a judgement call, because the alternative would be to not include the file at all, and some statistics really don't like that, and if you have a low n (e.g. clinical data), you often can't afford to be too picky. In practice, I've had this happen with a) mild muscle activity when many other channels had a lot of high muscle activity b) low amplitude low frequency irregular fluctuations in most channels. 

What counts as too much data being removed? I don't actually know. With 128 channels, there's a lot of redundant information in neighboring channels, and so interpolation (last preprocessing step) recovers essentially all the relevant EEG, especially for <12hz information. This process works less well when the channels being removed are on the periphery, but these also tend to contain less brain data in general. My personal criterion was whether the remaining channels/timepoints still captured visible EEG events in more than 1 channel (and again anything that would be removed with ICA).

Recommendation: if there are channels that are removed in a majority of datasets, jut remove them in all of the datasets.

Important: be consistent. If multiple people are cleaning the data, either have one person check the rest, or have each person handle a whole participant; don't introduce bias across conditions or groups.

Keep in mind: The reason this is manual is that there's so much variability across participants, conditions and brain states that automatic methods are unlikely to be flexible enough (in experiments like mine), and will either remove too much data, or too little noise. Furthermore, when running automatic scripts, you're less likely to know what's happening.

<p>&nbsp;</p>

### Removing channels vs removing timepoints
Sometimes it's obvious that a channel is bad. More often, a channel is sometimes bad, and sometimes fine.

## What's noise and what's signal

#### Clean Data
![](./images/CleanData1.PNG)

This data is 60 seconds of EEG across 128 channels, according to the following labels:

![](./images/128Ch.PNG)

<p>&nbsp;</p>

#### Eyes Open
![](./images/Biocalibration/EO.PNG)
> Bad channels have not been removed yet

<p>&nbsp;</p>

#### Eyes Closed
![](./images/Biocalibration/EC.PNG)
The circled area shows the artifect of eyes being closed. This will be removed with ICA. The central channels in the pannel are occipital channels, where alpha activity increases once eyes are closed (Berger Effect).

<p>&nbsp;</p>


#### Blinks
![](./images/Biocalibration/blink.PNG)
This is a participant blinking once per second. All eye movements get nicely removed with ICA. 

<p>&nbsp;</p>

#### Muscle & movement
![](./images/Biocalibration/Jaw&Eyes.PNG)
The thick dark band affecting almost all channels is muscle activity. This is a very prominent example, but it often occurs in smaller bursts, and in fewer channels. This can either be removed with intense filtering (LP <15Hz), which is suboptimal, or if it's localized in time like this, cut out that segment of data. Likewise if there's a couple of channels that show the same high-frequency activity all the time (because electrode was placed on a muscle), this channel should be removed.

The large sharp spikes in frontal channels (top band) is due to movement of the skin around the eyes shifting under the electrode. This is also what it looks like when the participants scratches the net, or similar. There's no filtering that away, it needs to be cut out. 

<p>&nbsp;</p>

#### Major movement
![](./images/Other/MajorBodyMovement.PNG)
This is when someone moves a lot of channels at once, for example if they shift the back of their heads against a back-rest. Cut it out.

<p>&nbsp;</p>

## Cleaning examples
![](./images/Other/BadCh.PNG)
The channels in red are the ones I choose to remove. The first three are indisputable; the fluctuations are completely out of whack relative to the rest of the EEG. This comes from poor contact of the electrode with the scalp.
The last channel is more subjective. I choose to remove channels with high frequency noise, especially when other channels are much cleaner.

<p>&nbsp;</p>

#### Good data


![](./images/Other/LOTStheta.PNG)
This is actually clean data; instead all the activity comes from a lot of theta oscillations in a strongly sleep deprivated individual. The channels removed had instead high-frequency noise, and occasional flares of poor contact (172-177s).


<p>&nbsp;</p>

![](./images/Standing/AllGood.PNG)
This is all clean, just alpha instead of theta. There are little things, but not worth the effort.

<p>&nbsp;</p>

![](./images/Standing/UglyData.PNG)
This is an example of "ugly" data, but no good reason (or method) for getting rid of it.


<p>&nbsp;</p>

![](./images/MWT/BadChUnselected3.PNG)
This instead, unlike above, is too "ugly", and should just get cut out. Importantly, the rest of the data is much cleaner. Those things that occur across all channels? Those are sleep-related oscillations, which tend to be more global than wake. If you see this in data in which participants should be wide awake, then maybe get suspicious.

<p>&nbsp;</p>

![](./images/MWT/sleep-swa.PNG)
Shown here is a microsleep in the middle of wake. Sleep has these global features. Usually something that occurs in all channels is likely noise, but when sleep kicks in, then it's physiological. You can suspect sleep by the eye closing saccade at the beginning, then slow rolling eye movements later on.


<p>&nbsp;</p>

![](./images/MWT/SWA.PNG)
This is real sleep slow waves. If you're seeing these in healthy wake, it's likely noise. But if sleep is even a little possible, don't take these out. 
Sleep often ends with major body movements. 


<p>&nbsp;</p>

![](./images/MWT/Spindles.PNG)
Sleep is also characterized by spindles, oscillations in the beta range (15-20Hz). These become pretty indestinguishable from muscle bursts, except the context; you don't get large muscle bursts in sleep, so when you have all the data spread in all the channels like this, you're dealing with sleep, not artefacts.


<p>&nbsp;</p>



#### Eyes


![](./images/Other/Saccadescut.PNG)
The circle indicates small saccades. These can be removed with ICA, although are a little harder to get rid of if the ICA filtering parameters aren't optimal. 

The top most channel removed is an example of a bad channel, even if the amplitude is not particularly high. This means it's probably not a big deal if it's not removed, but it likely also does not contain any valuable signal.

Intermediate channels were ones with high muscle activity. The last two channels removed were the chin electrodes, that pick up a lot of heartbeat. 

The teal areas indicate data to cut, based on small muscle bursts.


<p>&nbsp;</p>

![](./images/Standing/SEM.PNG)
These are eye artefacts when participants keep eyes closed. The slow rolling eye movements cause the big waves, and smaller movements cause these little sharp waves in between. All of it gets removed with ICA.



<p>&nbsp;</p>

![](./images/Standing/2Slow.PNG)
The top two channels have these slow oscillations that look a bit like slow rolling eye movements, typical of when participants have their eyes closed (which they do here). But since it's only in 2 channels, I think it's best to remove them, since I don't know that the ICA will remove them



<p>&nbsp;</p>

![](./images/Standing/WeirdEyes.PNG)
These little sharp waves can be removed with ICA.

<p>&nbsp;</p>

![](./images/MWT/HealthyEyes.PNG)
ICA should still be able to get rid of even this level of eye movement; just double check. Sometimes a whole component is dedicated to extremely large artifacts that are due more to moving electrodes than moving eyes.



<p>&nbsp;</p>



#### Noise

![](./images/MWT/verynoisy.PNG)
Pretty evident.



<p>&nbsp;</p>

![](./images/Other/unknown.PNG)
The channel indicated with an arrow is noise. It's particularly nefarious, because it's low amplitude oscillations around 1Hz, and so could go undetected. I think it comes from poor impedence. You can see in this CZ referenced data that it's the only channel showing this, but once you do average reference, it would bleed into the neighbors. 


<p>&nbsp;</p>

![](./images/Standing/Snippets.PNG)
Here are 2 examples of snippets to remove. The ones on the left are across multiple channels; that's due to a small body movement, so ICA is not good for it, but the rest of the data is really clean so it's a shame to cut it all out; so cut out the segment.

Same story for the spike on the right; it happens only in one channel, the channel is otherwise clean. Worth the effort to cut out just that spike.


<p>&nbsp;</p>

![](./images/Other/Spikes.PNG)
This is not a common type of noise, it was caused (I think) by a particularly static-y sweater the participant was wearing. But it created a lot of spikes, big and small, throughout the data. Some channels had the bulk of it, so I removed those. Other times there would be a big but rare spike for a channel, so I removed just that segment. Many times though, there were lots of little spikes, and I did not have the patience to remove them, so I left them in. Maybe if I get paid more I would remove them.


<p>&nbsp;</p>

![](./images/Standing/BadChGoodTime.PNG)
This is an example in which the same tiny high frequency noise is worth it to remove a whole channel where it comes and goes, but not the little column of data where there's a tiny burst of the same stuff everywhere. It's not a problem if you do get rit of the column, it's just not likely to make a difference to anything; it'll get averaged out.


<p>&nbsp;</p>

![](./images/MWT/BadCh2.PNG)
The top arrow points to heartbeat artefacts. No need to remove these channels, ICA will get rid of that. Instead the second arrow points to two bad channels that are clearly picking up on something systematic, but it's not data, it's not spread in other channels, so best thing is to cut them out.
I forgot to cut out the weird box noise between seconds 253 and 260; but that's also noise to remove.

<p>&nbsp;</p>

![](./images/MWT/datacut.PNG)
The line is what happens when you pause an EEG recording. Technically, it's also what happens whenever you select a column of data to remove, so it would be completely pointless to cut out this piece of data since it wouldn't change anything for the analyses later. 

<p>&nbsp;</p>

#### Muscles
![](./images/MWT/BadChUnselected.PNG)
In the end, it's a choice, but I think it's good to remove channels that obviously stand out as having high-frequency noise; marked with arrows.
"Stand out" is important; when the data is really noisy, a channel like the first one might be relatively clean, and so to avoid removing too much data, I'd leave it in. But in this case, with such clean data, I can afford to get rid of even little bits of noise. 
Data from 9 to 16 should be cut out as colunm.

<p>&nbsp;</p>

![](./images/MWT/BadChUnselected2.PNG)
Another example of few channels that are just a little bad that I get rid of. 


<p>&nbsp;</p>

![](./images/MWT/BadChUnselected3.PNG)
Here instead there are too many channels with high-frequency noise to have the same criterion. So instead I get rid of the worst ones, avoiding as much as possible removing adjacent channels to avoid having large patches of missing channels.
N.B. don't fall for the slippery slope fallacy: just because there's no clear point at which to say something is noise and something is fine, doesn't mean you shouldn't at least try to get rid of the worst of it. 


<p>&nbsp;</p>

![](./images/MWT/CutTimeNotCh.PNG)
It often happens that there's a few channels that show muscle activity, together, but only periodically. If the channel is usually clean, better to cut out the bursts of noise. If it's a hard call, then remove the bad segments selectively.



<p>&nbsp;</p>

#### Edge cases

![](./images/MWT/RelativeMessy.PNG)
The data being cut out here might actually be ok in a particularly messy recording, but since it is rare here, and the rest of the data is so clean, I cut it out. 

<p>&nbsp;</p>

![](./images/MWT/SmallBad.PNG)
Here, the person moved, and caused lots of little things to happen in the same time frame. It's not major, but if you've got plenty of data, you can afford to get rid of it. 


<p>&nbsp;</p>

![](./images/MWT/Weirdness2.PNG)
I have no idea what those are. I suspect it's eye-stuff, for sure it's not brain data. So to err on the side of caution, I remove it. 


<p>&nbsp;</p>

![](./images/MWT/yesandno.PNG)
The left-most arrow indicates a slow wave. In a sleep deprivation study, this is to be expected, so doesn't get removed.

The next arrow indicates a channel with light high-frequency activity. It's really borderline if it's worth keeping or not. 

Instead, the topmost and bottom-most arrows points to channels which are much noisier, with the high-frequency spikes having the same amplitude as nearby oscillations. I'm pretty convinced about getting rid of it in this case. 

The last arrow in the middle right points to an alpha burst. That definitely stays. 




<p>&nbsp;</p>

#### Salvaging horrible data

![](./images/SpFT/ICAvsCh.PNG)
When faced with always bad data, you can leave channels that have low-frequency thingies that are synchronized across channels, even if not really sure what they are. ICA is good at removing things that come from the same source, synchronized in multiple channels and are <20Hz. Instead, the high muscle noise needs to be removed as is (as far as I know).


<p>&nbsp;</p>

![](./images/SpFT/rem17ch.PNG)
This data was recorded during speech. When possible, don't record during speech. The channels removed were because of constant muscle activity, or major artefacts from jaw movement. 17 channels were removed. 

Instead, the area circled is actually an eye artefact that accompanied speech (they were reading what they were speaking, might be that). Still, means that it can be removed with ICA.


<p>&nbsp;</p>

![](./images/SpFT/TheWorst.PNG)
If most of your data looks like this, cry. Then remove the channels that contain no brain data left, time segments with huge artefacts, and leave the rest, but only do analyses that won't try to interpret those remaining artefacts as signal (like peak detection, or beta power analyses).

